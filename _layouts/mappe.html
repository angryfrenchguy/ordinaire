---
layout: default
---
  <div id='map' style='height:100vh'></div>

  <script>
    // const mapboxgl = require('mapbox-gl');

    var layer = getLaMappe();

    mapboxgl.accessToken = 'pk.eyJ1IjoieG9icGFtNjY2IiwiYSI6ImNqZnBiY3E0ZTBmbDUzM3FvMjZta3IxZWYifQ.Y8TVWK0bfi0mRBnz8cMLdw';
    var map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/xobpam666/' + layer,
      center: [-71.207, 46.809], // starting position [lng, lat]
      zoom: 12 // starting zoom
    });

    // Code pour voir le popup

    map.on('click', function(e) {
      var features = map.queryRenderedFeatures(e.point, {
        layers: ['stat-qc-0148yg']
      });

      if (!features.length) {
        return;

      }

      var feature = features[0];

      var popup = new mapboxgl.Popup({
          offset: [0, -15]
        })
        .setLngLat(feature.geometry.coordinates)
        .setHTML(
          '<b>' + feature.properties._0 + '</b> <br> \
            <p>Horaire :  ' + feature.properties.Horaire + '</p><br> \
            <p>Nuit? ' + feature.properties.Nuit +
          '</p><br> \
            <input id="vamonos" type="button" onclick="location.href=' + '&quot;' + feature.properties
          .gmap + '&quot;' + '" value="Vamonos!" />'
        )
        .setLngLat(feature.geometry.coordinates)
        .addTo(map);
    });

    // Code pour changer le curseur en pointeur sur les éléments clickables. Pas clair comment faire ne mode mobile.

    map.on("mousemove", function(e) {
      //get the feature underneath the mouse
      var features = map.queryRenderedFeatures(e.point, {
        layers: [layer]
      });
      //if there's a point under our mouse, then do the following.
      if (features.length > 0) {
        //use the following code to change the
        //cursor to a pointer ('pointer') instead of the default ('')
        map.getCanvas().style.cursor = (features[0].properties.Name !== null) ? 'pointer' : '';
      }
      //if there are no points under our mouse,
      //then change the cursor back to the default
      else {
        map.getCanvas().style.cursor = '';
      }
    });

    // Code pour la position de l'utilisateur

    map.addControl(new mapboxgl.GeolocateControl({
    positionOptions: {
        enableHighAccuracy: true
    },
    trackUserLocation: true
}));

  </script>
